# SMS Platform Сlient

Содержание:
- [SMS Platform client](#sms-platform-client)
  - [Описание](#описание)
  - [Функционал](#функционал)
  - [Установка](#установка)
  - [Настройка](#настройка)
  - [Использование](#использование)
  - [Тестирование](#тестирование)
    - [Юнит-тесты](#юнит-тесты)
    - [Интеграционное тестирование с мок-сервером](#интеграционное-тестирование-с-мок-сервером)
  - [Логирование](#логирование)

## Описание

`sms_cli` - это CLI-программа, которая будет являться клиентом к условному
сервису отправки СМС-сообщений.

## Функционал

 - Отправка сообщений через HTTP-запросы.
 - Чтение конфигурации из TOML-файла.
 - Логирование запросов и ответов в лог-файл.
 - Обработка HTTP-запросов и ответов с использованием пользовательских классов.

## Установка

1. Клонирование репозитория:
```bash
git clone https://github.com/vladislav-gh-dump/sms-platform-client.git
cd sms-platform-client
```

2. Установка зависимостей:
```bash
pip install -r requirements.txt
```

## Настройка

Параметры указываются в конфигурационном файле `config.toml`:
```toml
[server]
host = "localhost"
port = 4010
path = "/send_sms"

[auth]
username = "user1"
password = "123"
```

## Использование

Для отправки сообщений используется команда:
```bash
python -m sms_cli <sender> <recipient> <message>
```

Аргументы:
 - `sender`: номер телефона отправителя
 - `recipient`: номер телефона получателя
 - `message`: текст сообщения

Получение справки:
```bash
python -m sms_cli -h
```

## Тестирование

### Юнит-тесты

Для проверки отдельных компонентов программы используются юнит-тесты. Запуск выполняется через `pytest`:
```bash
pytest
```

#### Проблема с pyreadline

Если при запуске тестов возникает ошибка:
```bash
AttributeError: module 'collections' has no attribute 'Callable'
```

Удалите библиотеку `pyreadline`:
```bash
pip uninstall pyreadline
```

### Интеграционное тестирование с мок-сервером

Можно протестировать работу программы в реальном сценарии, запустив мок-сервер и отправив тестовое сообщение:

1. Запустите мок-сервер:
```bash
python mock_server
```

2. Отправьте сообщение:
```bash
python -m sms_cli <sender> <recipient> <message>
```

## Логирование

Информация об ошибках, переданных параметрах командной строки и полученных от сервиса ответов сохраняется в лог-файл `sms_cli.log`.
